% Estilo de Tesis de la Universidad Técnica Federico Santa María
% Departamento de Informática.
% Valparaíso, Chile
%
% Modificado por Romina Torres y Rodrigo Salas Fuentes 
% 2002.
%
% Modificado de:
%-%  Dalhousie University thesis style
%-%  Dept. of Math. Stats. and Comp. Sci.
%
% Modificado de:
%
%-% Stanford University PhD thesis style -- modifications to the report style
%-% For LaTeX version 2.09
%-% Last edit Tue Sep 13 14:40:26 1988
%-% Last edit by Joseph Pallas
%
%
% Ultima edición: 4 Julio 2002
%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{utfsm_tesis}[2002]  %Estilo de TEsis de la UTFSM
\typeout{Tesis Info Style}
\RequirePackage{ifthen}
\RequirePackage{latexsym}
\RequirePackage{tabularx}  


\typeout{Opciones de Estilo del Documento 'UTFSM_tesis'.}

\long\def\comment#1{}
\comment{

  Ejemplo del Modo de Uso:
    \documentstyle[12pt,UTFSM_Tesis]{report}
    \begin{document}
    \title{Como escribir una Tesis\\
        con dos Líneas en los Títulos}
    \author{Rodrigo Salas}
    
    \profguia{Profesor Guía}          %Cambiado a partir de supervisor
    \profcorr{Profesor Correferente} %Cambiado a partir de firstreader
    \profext{Profesor Externo}     %Cambiado a partir de secondreader

    \dedicate{
    Esta parte es Opcional\\
    Página de dedicación.\\
    }

    \beforepreface
 
    \prefacesection{Abstract}
    Un resumen es requerido en todas las Tesis. Asegurarse que alcance en una página!.

    \afterpreface
 
    \chapter{Introducción}
     ...
    \chapter{Conclusiones}
     ...
    \appendix
    \chapter{Demostraciones}
     ...
    \bibliographystyle{plain}
    \bibliography{mybib}
    \end{document}

Documentación:
    
        Este archivo de estilo modifica el estilo de reporte estandard para 
    respetar las "Regulaciones para la submisión de Tesis" de la escuela 
    de graduados de la Universidad Técnica Federico Santa María. Coloca 
    los márgenes y el interlineado requerido y desabilita los saltos de 
    páginas y 'hypens'.

    El comando \beforepreface crea la página de título, la página de firmas
    y la página de permisos (opcionalmente). Por lo tanto el usuario debería
    colocar la sección de prefacio usando el comando \prefacesection{section title}.
    El comando \afterpreface produce las tablas de contenidos, tablas y figuras 
    (opcionalmente), y coloca las cosas al comienzo del cuerpo principal 
    (en la página 1 con número arábigo).
    
    Los siguientes comandos controla el typesetting de de tu Tesis:
    
   Información Básica:

    \title{Título de Tesis}
        - Aparecerá grande en la página i. Si es demasiado grande
        se separará automáticamente en líneas diferentes. Para 
        especificar  salto de línea usar el comando \\ dentro del 
        título.
        \title{Very Long\\Title\\Split Over\\Several Lines}
        Asegurarse que no existe espacio antes de \\.

    \author{Nombre del autor}
        - Tu nombre como deseas que aparezca en tu Tesis.

   Información de Graduación y Submisión:

    \submitdate{mes año en la cual se entregó a la Escuela de Graduados}
        - decha LaTeX si se omite

    \copyrightyear{Año de la Tesis}
        - Año del LaTeX si se omite

    \convocation{mes}{año}
        - Fecha de convocatoria.

   Especificación del Grado:

    \msc
        - Grado a obtener es Master of Science, M.Sc. 
    \ma     
        - Grado a obtener es Master of Arts, M.A.
    \phd    
        - Grado a obtain es Doctor of Philosophy, Ph.D.
    \ingej
        - Grado a obtener es Ingeniero Ejecución, Ing.Ej.
    \ingciv
        - Grado a obtener es Ingeniero Civil, Ing.Civ. (defecto)
    \magister
        - Grado a obtener es Magister, Mg.
    \doctor
        - Grado a obtener es Doctor, Dr.



   Firmas:

    \profguia{Nombre del Profesor Guia}
        - Incluye nombre del Profesor Guía del Investigador.
    \profcorr{Nombre del Profesor Correferente}
        - Incluye el nombre del Profesor Correferente.
    \profext{Nombre del Profesor Externo}
        - Incluye el nombre del Profesor Externo (Sólo en Magister y en Doctor)
   
   
   Comandos de seccionamiento:

    \dedicate{
      Priemra línea\\
      Segunda línea\\
      Ultima línea.
    }
        - Produce la página opcional de dedicación.
        Se debe colocar antes del comando \beforepreface.
    
    \prefacesection{Cualquier cosa}
    Blah, blah, blah...
        - Produce una sección de prefacio como el Resumen, 
          reconocimientos, etc. Debe aparecer entre los comandos
          \beforepreface \afterpreface.
          Typeset similar a los capítulos y no está numerado.

    \chapter{Cualquier cosa}
    Blah, blah, blah...
        - Produce una sección de capítulo enumerada.

    \section{Nombre de la sección}
        - Colocado después del capítulo.
    
    \subsection{Nombre de la sección}
        - Colocado después de una sección.

    \appendix
        - Colocar este comando antes del primer capítulo apéndice.
          Usar el comando \chapter.  Será colocado con letra y no 
          con número.

    \nonumchapter{Cualquier cosa}
    Blah, blah, blah...
        - Produce una sección de capítulo que no está numerado, 
          como por ejemplo la Introducción. Se utiliza de la 
          misma manera que el comando \chapter.

   Imprimiendo copias draft:

    \draft
        - Para imprimir copias draft de la tesis. Especifica en la 
        cabecera que la copia es un draft y espicifica la fecha de impresión.
        También especifica el draft y la fecha en la página título.

    \nofront
        - Especifica no imprimir las páginas de firma y Permisos, 
        tablas de contenidos, y la lista de las figuras y tablas. 
        Util para las copias de borrador para disminuir la impresión.

    \nobib
        - Suprime la impresión de la bibliografía.
        Util para las copias borrador para disminuir la impresión.

   Comandos especializados:

    \nolistoffigures
        - No produce la lista de las figuras.
    \nolistoftables
        - No produce la Lista de las tablas.
    \twosupervisors
        - Utilizar cuando se tiene dos supervisores en vez de uno.
          Nombre dado por \profguia{} va primero, \profcorr{} 
          va segundo. Puede ir con el formato de Ph.D.
    \univerity{Nombre de la Universidad}
        - "Universidad Técnica Federico Santa María" por defecto.  Se puede usar salto de línea.
    \address{Dirección de la Universidad}
        - "Av. España 1680, Valparaíso" por defecto.
    \dept{Departamento del Autor}
        - "Informática" por defecto.
    \faculty{Grado que otorga la Facultad}
        - [Facultad de] "Graduados" por defecto
    \degree{Título completo del grado}
    \degreeinitial{F.D.T.}
        - Especifica el nombre del grado e iniciales.
          \degree{Master of Business Administration}
          \degreeinitial{M.B.A.}
    \permissionfalse
        - No produce la página de permiso (verdadero por defecto)

Este estilo utiliza interlineado que es 1.37 veces lo normal, excepto
en los ambientes de figuras y tablas donde se utiliza un espaciamento normal.
Se puede cambiar al hacer:

    \renewcommand{\baselinestretch}{1.5}
(o cualquier cosa que se desee en vez de 1.5)

Desafortunadamente, probablemente el comando no tenga efecto al menos que esté antes que
\begin{document} o después del comando de cambio del tamaño de la letra  como por ejemplo 
\small or \normalsize.

El ejemplo de arriba muestra 12pt substyle siendo utilizado. Esto es requerido 
para entregar una copia, pero se puede omitir para imprimir un borrador más pequeño.
Notar que el material del front puede no verse bien en una copia pequeña.
}


% --------------------------------------------------------------------------------------------%
% ----------                           FIN DEL COMENTARIO                             --------%
% --------------------------------------------------------------------------------------------%



% Define la cabecera de la página para enumerarla solamente.
%\newcommand{\properpagestyle}{ 
%       \pagestyle{myheadings}\markboth{}{}\markright{}}
\newcommand{\properpagestyle}{ 
       \pagestyle{plain}}


% Lo primero que se hace es ver si el reporte ha sido cargado. 
% Un error común es tratar de usar suthesis como un documentstyle.

\@ifundefined{chapter}{\@latexerr{La opción de `UTFSM_Tesis' debería ser usado
con el estilo de documento `report'}{Usted debería leer la documentación de UTFSM_Tesis.}}{}

% Se necesita un margen de 1" excepto en la página de binding la cual es de 1 1/2"
% Las Tesis son por un lado, por lo tanto no nos preopcupamos por \evensidemargin
\oddsidemargin 0.5in \evensidemargin 0in
\marginparwidth 40pt \marginparsep 10pt
\topmargin 0pt \headsep .5in
\textheight 8.1in \textwidth 6in

% No permitir salto de páginas en hyphens (Esto dará algunos underfull vbox's,
% entonces una alternativa es usar \brokenpenalty=100 y manualmente buscar por
% y arreglar tales saltos de páginas.)
\brokenpenalty=10000

% Usar 1.37 veces el salto baseline-to-baseline normal 
\renewcommand{\baselinestretch}{1.37}

% Redefinir los macors utilizados para flotantes (incluyendo tablas y figuras)
% de manera tal que se usa un espaciamiento simple.
% (Notar que \def\figure{\@float{figure}set single spacing} no funciona
%  porque la figura tiene un argumento opcional.)
%
%\def\@xfloat#1[#2]{\ifhmode \@bsphack\@floatpenalty -\@Mii\else
%   \@floatpenalty-\@Miii\fi\def\@captype{#1}\ifinner
%      \@parmoderr\@floatpenalty\z@
%    \else\@next\@currbox\@freelist{\@tempcnta\csname ftype@#1\endcsname
%       \multiply\@tempcnta\@xxxii\advance\@tempcnta\sixt@@n
%       \@tfor \@tempa :=#2\do
%            {\if\@tempa h\advance\@tempcnta \@ne\fi
%             \if\@tempa t\advance\@tempcnta \tw@\fi
%             \if\@tempa b\advance\@tempcnta 4\relax\fi
%             \if\@tempa p\advance\@tempcnta 8\relax\fi
%     }\global\count\@currbox\@tempcnta}\@fltovf\fi
%    \global\setbox\@currbox\vbox\bgroup 
%    \def\baselinestretch{1}\@normalsize
%    \boxmaxdepth\z@
%    \hsize\columnwidth \@parboxrestore}

% Redefinir los macros utilizados para los pie de páginas para usar espaciamiento simple.
\long\def\@footnotetext#1{\insert\footins{\def\baselinestretch{1}\footnotesize
    \interlinepenalty\interfootnotelinepenalty 
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth \@parboxrestore
   \edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}\@makefntext
    {\rule{\z@}{\footnotesep}\ignorespaces
      #1\strut}}}

% \author, \title son definidos en el reporte; aquís está el resto de los
% front que definen macros.
\def\university#1{\gdef\@university{#1}}
\def\address#1{\gdef\@address{#1}}
\def\dept#1{\gdef\@dept{#1}}
\def\faculty#1{\gdef\@faculty{#1}}
\def\profguia#1{\gdef\@profguia{#1}}
\def\profcorr#1{\gdef\@profcorr{#1}}
\def\profext#1{\gdef\@profext{#1}}
\def\twosupervisors{\two@supervisorstrue}
\def\ack#1{\gdef\@ack{#1}}
\def\resumenesp#1{\gdef\@resumenesp{#1}}
\def\resumening#1{\gdef\@resumening{#1}}
\def\abreviaciones#1{\gdef\@abreviaciones{#1}}
\def\submitdate#1{\gdef\@submitdate{#1}}
\def\copyrightyear#1{\gdef\@copyrightyear{#1}} % \author, \title en reporte.
\def\degree#1{\gdef\@degree{#1}}
\def\degreeinitial#1{\gdef\@degreeinitial{#1}}
\def\msc{\degree{Master of Science}\degreeinitial{M.Sc.}}
\def\phd{\degree{Doctor of Philosophy}\degreeinitial{Ph.D.}\ph@dtrue}
\def\ma{\degree{Master of Arts}\degreeinitial{M.A.}}
\def\ingej{\degree{Ingeniero en Ejecución}\degreeinitial{Ing.Ej.}}
\def\ingciv{\degree{Ingeniero Civil}\degreeinitial{Ing.Civ.}}
\ingciv % grado por defecto
\def\magister{\degree{Mag\'ister en Ciencias de la Ingeniería Informática}\degreeinitial{Mg.}\ph@dtrue}
\def\doctor{\degre{Doctor}\degreeinitial{Dr.}\ph@dtrue}
\def\@title{}
\def\@author{}
\def\@university{Universidad Técnica Federico Santa María}
\def\@address{Av. España 1680, Valparaíso}
\def\@dept{Informática}
\def\@faculty{Graduados}
\def\@profguia{}\def\@profcorr{}\def\@profext{}
\def\@submitdate{\ifcase\the\month\or
  Enero\or Febrero\or Marzo\or Abril\or Mayo\or Junio\or
  Julio\or Agosto\or Septiembre\or Octubre\or Noviembre\or Deciembre\fi
  \space \number\the\year}
\def\@copyrightyear{\number\the\year}

\def\convocation#1#2{\gdef\@convocationmonth{#1}\gdef\@convocationyear{#2}}
\def\@convwarn{\typeout{Alerta:  El dia de la convocatoria puede estar incorrecto!}}

\def\dedicate#1{\dedic@tiontrue\gdef\dedication@text{#1}}

\def\draft{\renewcommand{\properpagestyle}{\pagestyle{myheadings}
\markright{{\rm Versión  Borrador -- \today}}}\draft@modetrue\properpagestyle}
\def\nobib{\print@bibfalse}
\def\nolistoffigures{\figurespagefalse}
\def\nolistoftables{\tablespagefalse}
\def\nolistofalgorithms{\algorithmspagefalse}
\def\nofront{\front@pagesfalse\permissionfalse\figurespagefalse\tablespagefalse\algorithmspagefalse}

% New if constructs:    Default conditions:
\newif\ifpermission     \permissiontrue  
\newif\iffigurespage    \figurespagetrue 
\newif\iftablespage     \tablespagetrue
\newif\ifalgorithmspage \algorithmspagetrue
\newif\iffront@pages    \front@pagestrue
\newif\ifthird@reader   \third@readerfalse
\newif\iffourth@reader  \fourth@readerfalse
\newif\iffifth@reader   \fifth@readerfalse
\newif\ifph@d           \ph@dfalse
\newif\iftwo@supervisors \two@supervisorsfalse
\newif\ifdraft@mode     \draft@modefalse
\newif\ifprint@bib      \print@bibtrue
\newif\ifdedic@tion     \dedic@tionfalse

\def\no@breaks#1{{\def\\{ \ignorespaces}#1}}    % disallow explicit line breaks

\def\titlep{
    \thispagestyle{empty}
    \hspace{-0.5cm}
    \begin{tabular}{c >{\centering\vspace{-1.7cm}}p{9.5cm} c}
    \epsfig{file=images/logo_inf,width=65pt} &
    \textsc{\expandafter{\@university} \\
    Departamento de \expandafter{\@dept} \\  
    Valparaíso -- Chile} &
    \epsfig{file=images/logo_usm,width=70pt}
    \end{tabular}
    \ifdraft@mode
      \begin{center} \Large DRAFT COPY\\ \large Printed \today \end{center}
    \fi
    \null\vskip1.2in
    \begin{center}
        \hyphenpenalty=10000\Large \textbf{\uppercase\expandafter{\@title}}
    \end{center}
    \vfill
    \begin{center}
        \large\rm Tesis presentada como requerimiento parcial\\
        \large\rm para optar al grado académico de\\
        \vskip 0.2in
        \Large \uppercase\expandafter{\@degree} \\
        \Large\rm y al t\'itulo profesional de\\
        \Large \uppercase{Ingeniero Civil en Inform\'atica} \\
        \Large\rm por\\
        \Large\rm \textbf{\@author}
    \end{center}
    \vfill
    \begin{center}
    \addtocounter{page}{-1}
        %Como requisito para optar al grado de:\\
        %\uppercase\expandafter{\@degree} \\
    
        %\uppercase\expandafter{\@university} \\
        %\uppercase\expandafter{\@address} \\
        \vskip0.3in       
        \large Comisión Evaluadora: \\
        \large \expandafter{\@profguia} (Guía, UTFSM) \\
        \large \expandafter{\@profcorr} (UTFSM)\\
        \large \expandafter{\@profext}  (UdeC)\\
        %\uppercase\expandafter{\@submitdate}
    \end{center}
    \vskip0.25in
    \begin{center}
        %\rm \copyright\ Derechos de \@author, \@copyrightyear
        \uppercase\expandafter{\@submitdate}
    \end{center}\newpage}

\def\signature#1#2{\parbox[b]{1in}{\smash{#1}\vskip12pt}
\hfill \parbox[t]{3in}{\shortstack{\vrule width 3in height 0.4pt\\\small#2}}}

\def\signaturepage{%
    \setcounter{page}{2}
    \begin{quotation}
    \begin{center}
        \textsc{\expandafter{\@university} \\
        Departamento de \expandafter{\@dept} \\
        Valparaíso -- Chile}
        %\uppercase\expandafter{\@university} \\
        %DEPARTMENTO DE 
        %\uppercase\expandafter{\@dept}
    \end{center}
    
    \null\vskip0.2in
    
    \noindent TITULO DE LA TESIS:\\
    \textbf{\uppercase\expandafter{\@title}}
    
    \null\vskip0.2in
    
    \noindent AUTOR:\\
    \textbf{\uppercase\expandafter{\@author}}
    
    
    \null\vskip0.2in
    
    Tesis presentada como requerimiento parcial para optar al grado académico de
    \textbf{\@degree} y al título profesional de \textbf{Ingeniero Civil en Informática} \ de la \@university.

     

    \iffourth@reader
        \def\sigskip{\vskip0.15in plus 0.2in minus 0.1in}
        \def\beginskip{\vskip0.3875in plus 0.2in minus 0.1in}
    \else
        \def\sigskip{\vskip0.4in plus 0.1in}
        \def\beginskip{\vskip0.5875in plus 0.1in}
    \fi

    \ifph@d
        \beginskip
        \signature{\@profguia}{Profesor Guía} \\
        \sigskip \signature{\@profcorr}{Profesor Correferente} \\
        \sigskip \signature{\@profext}{Profesor Externo} \\
        
    \else % not Ph.D. degree:
        \beginskip
        \signature{Profesor Guía:}{\@profguia} \\
        \sigskip \signature{Profesor Correferente}{\@profcorr} \\
    \fi

        
    \vskip0.2in plus 1fill minus 0.1in
    \begin{flushright}
    \@submitdate. \\
    Valparaíso, Chile. 
    \end{flushright}


    \end{quotation}
    \vfill\newpage\setcounter{page}{2} }


\def\beforepreface{
\typeout{Most over/underfulls in first few pages are the fault of dalthesis.}
\typeout{Ignore all them.  If uncorrectable errors occur, notify staff.}
    \pagenumbering{roman}
    \pagestyle{plain}
    \titlep
    \iffront@pages\signaturepage\else\addtocounter{page}{1}\fi
   %\ifpermission\permissionpage\else
    \addtocounter{page}{1} %\fi
    \iffront@pages\ifdedic@tion
        \newpage \begin{flushright}
        \ \vskip5in
        \Large\em\null\vskip1in
        \dedication@text
        \end{flushright}
    \fi\fi
    
    
    % ------------------------------------------------------------------------
    {
    \typeout{Acknowledgements}
    \include{\@ack}
    }
    {
    \typeout{Resumen}
    \include{\@resumenesp}
    }
    {
    \typeout{Abstract}
    \include{\@resumening}
    }
         
    \iffront@pages\tableofcontents\else\addtocounter{page}{1}\fi
    \newpage
    \iftablespage
        \addcontentsline{toc}{chapter}{List of Tables}\listoftables
        \newpage
    \fi
    \iffigurespage
        \addcontentsline{toc}{chapter}{List of Figures}\listoffigures
        \newpage
    \fi
    \ifalgorithmspage
        \addcontentsline{toc}{chapter}{List of Algorithms}\listofalgorithms
        \newpage
    \fi
    {\typeout{Abbreviations} 
     \include{\@abreviaciones}   
     }    
    
    
}
\def\nonumchapter#1{%
    \chapter*{#1}
    \addcontentsline{toc}{chapter}{#1}}

\def\prefacesection#1{%
    \chapter*{#1}
    \addcontentsline{toc}{chapter}{#1}}

\newenvironment{dedication}{\newpage\begin{center}\Large\em\null\vskip1in}%
{\vfill\end{center}}


\def\afterpreface{\newpage
    \pagenumbering{arabic}
    \pagestyle{plain}
    \typeout{Las páginas del prefacio de la UTFSM_Tesis han sido escritas}
    \properpagestyle}

% Redefine \thebibliography para ir a una nueva página y colocar la entrada en la 
% tabla de contenidos
\let\@ldthebibliography\thebibliography
\renewcommand{\thebibliography}[1]{%
    \newpage
    \addcontentsline{toc}{chapter}{Bibliography}
    \@ldthebibliography{#1}
}

\let\@ldbibliography\bibliography
\renewcommand{\bibliography}[1]{\ifprint@bib\@ldbibliography{#1}\fi}

% Comenzar Normal.
\properpagestyle
